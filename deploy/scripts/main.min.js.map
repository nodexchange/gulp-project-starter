{"version":3,"sources":["core.js"],"names":["com","aol","one","ri","$1CRI","utils","aspectRatio","getCurrentAspectRatio","resizeImagePerRatio","element","maxWidth","maxHeight","ratio","width","height","resizeType","Settings","this","Clickthrough","ADTECH","getContent","Image","Source","Clickable","Scale to Fit","Default Width","Default Height","CloseButton","top","right","Close Button Image","VideoPlayer","Enabled","Volume","MP4 File","Preview Image","End Image","Auto Play","Layout","Height","Width","X","Y","WEBM File","imageContainer","dimensions","settings","defaultWidth","defaultHeight","scaleToFit","image","createImg","w","h","style","cursor","prototype","setVisible","show","display","getImage","fileSrc","img","document","createElement","src","updateSize","smartVideo","closeButton","button","setupButton","contractBtn","className","position","onclick","clickHandler","close","core","container","videoContainer","id","Math","random","appendChild","originalWidth","originalHeight","currentAspectRatio","setupVideo","e","console","log","getVideoContainer","self","registerVideoPlayer","smartPlayer","modules","SmartVideoPlayer","createPlayer","poster","autoplay","mp4","webm","left","play","auto","pause","firstChild","screenDimensions","addCoreEventListeners","requestViewportDimensions","init","body","dims","getScreenSize","backgroundImage","addEventListener","event","type","meta","dynamicClick","ready"],"mappings":"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","file":"main.min.js","sourcesContent":["'use strict';\n// JSLint\n/*global\nADTECH, $1CRI, $include\n*/\n/**\n * Mobile Responsive Interstitial\n * AOL Platforms 02/2016\n * http://one.aol.com/\n * version 0.1\n *\n * @author: Marcin Wojtala\n */\nvar com = com || {};\ncom.aol = com.aol || {};\ncom.aol.one = com.aol.one || {};\ncom.aol.one.ri = com.aol.one.ri || {};\nvar $1CRI = com.aol.one.ri;\n;\n$1CRI.utils = {\n  aspectRatio: 1,\n  getCurrentAspectRatio: function() {\n    return $1CRI.utils.aspectRatio;\n  },\n  resizeImagePerRatio: function(element, maxWidth, maxHeight) {\n    var ratio = 0; // Used for aspect ratio\n    var width = element.width // Current image width\n    var height = element.height // Current image height\n\n    var resizeType = 'portrait';\n    if (maxWidth<maxHeight) {\n      resizeType = 'landscape';\n    }\n    if (resizeType == 'landscape') {\n      // Check if the current width is larger than the max\n      if (width < maxWidth) {\n        ratio = maxWidth / width; // get ratio for scaling image\n        $1CRI.utils.aspectRatio = ratio;\n        element.width = maxWidth; // Set new width\n        element.height = height * ratio; // Scale height based on ratio\n        height = height * ratio; // Reset height to match scaled image\n        width = width * ratio; // Reset width to match scaled image\n      }\n    } else {\n      // Check if current height is larger than max\n      if (height < maxHeight) {\n        ratio = maxHeight / height; // get ratio for scaling image\n        $1CRI.utils.aspectRatio = ratio;\n        element.height = maxHeight; // Set new height\n        element.width = width * ratio; // Scale width based on ratio\n        width = width * ratio; // Reset width to match scaled image\n        height = height * ratio; // Reset height to match scaled image\n      }\n    }\n  }\n}\n;\n$1CRI.Settings = function () {\n  this.Clickthrough = ADTECH.getContent('Clickthrough', 'https://ad.doubleclick.net/ddm/clk/300049047;127005073;');\n  this.Image = ADTECH.getContent('Image', {\"Source\":\"images/320x480.jpg\",\"Clickable\":\"true\",\"Scale to Fit\":\"true\",\"Default Width\":\"320\",\"Default Height\":\"480\"});\n  this.CloseButton = ADTECH.getContent('CloseButton', {\"top\":-18,\"right\":-18,\"Close Button Image\":\"closeButton_100x100.png\"});\n  this.VideoPlayer = ADTECH.getContent('VideoPlayer', {\"Enabled\":\"true\",\"Clickable\":\"true\",\"Clickthrough\":\"https://ad.doubleclick.net/ddm/clk/300049047;127005073;\",\"Volume\":\"0.2\",\"MP4 File\":\"images/Kadjar_10_OPO_070116.mp4\",\"Preview Image\":\"\",\"End Image\":\"\",\"Auto Play\":true,\"Layout\":\"Fluid||Fixed\",\"Height\":170,\"Width\":320,\"X\":0,\"Y\":40,\"WEBM File\":\"\"});\n};\n\n// module.exports = $1CRI.Settings;\n;\n$1CRI.imageContainer = function(dimensions, settings) {\n  this.utils = $1CRI.utils;\n  var clickable = settings.Clickable;\n  var defaultWidth = settings['Default Width'];\n  var defaultHeight = settings['Default Height'];\n  var scaleToFit = settings['Scale to Fit'];\n  this.image = this.createImg(settings.Source, defaultWidth, defaultHeight);\n  if (scaleToFit) {\n    this.utils.resizeImagePerRatio(this.image, dimensions.w, dimensions.h);\n  }\n  if (settings.Clickable === true || settings.Clickable === 'true') {\n    this.image.style.cursor = 'pointer';\n  }\n  return this;\n};\n$1CRI.imageContainer.prototype = {\n  setVisible: function(show) {\n    if (show === true) {\n      this.image.style.display = '';\n    } else {\n      this.image.style.display = 'none';\n    }\n  },\n  getImage: function() {\n    return this.image;\n  },\n  createImg: function(fileSrc, width, height) {\n    var img = document.createElement('img');\n    img.src = fileSrc;\n    // Forced for retina display\n    img.width = width;\n    img.height = height;\n    return img;\n  },\n  updateSize: function(dimensions) {\n    this.utils.resizeImagePerRatio(this.image, dimensions.w, dimensions.h);\n  }\n};\n;\nvar $1CRI = $1CRI || {};\n$1CRI.smartVideo = $1CRI.smartVideo || {};\n\n$1CRI.closeButton = function(settings) {\n  this.settings = settings;\n  var button = this.setupButton();\n  return button;\n};\n\n$1CRI.closeButton.prototype = {\n  setupButton: function() {\n      var contractBtn = document.createElement('img');\n      contractBtn.className = 'closeButton';\n      contractBtn.src = this.settings['Close Button Image'];\n      contractBtn.style.position = 'absolute';\n      contractBtn.style.right = '4px';\n      contractBtn.style.top = '4px';\n      contractBtn.onclick = function() {\n\n      };\n      return contractBtn;\n  },\n  clickHandler: function() {\n    ADTECH.close();\n  }\n};\n;\nvar $1CRI = $1CRI || {};\n$1CRI.smartVideo = $1CRI.smartVideo || {};\n\n$1CRI.smartVideo.core = function(settings, container) {\n  this.utils = $1CRI.utils;\n  this.videoContainer = document.createElement('div');\n  this.videoContainer.id = 'VideoContainer' + (Math.random() * 1000);\n  container.appendChild(this.videoContainer);\n  this.settings = settings;\n  this.originalWidth = this.settings.Width;\n  this.originalHeight = this.settings.Height;\n  this.currentAspectRatio = 1;\n  try {\n    this.setupVideo();\n  } catch (e) {\n    console.log('[SMART PLAYER ERROR]' +e);\n  }\n  return this;\n};\n\n$1CRI.smartVideo.core.prototype = {\n  getVideoContainer: function() {\n    return this.videoContainer;\n  },\n  setupVideo: function() {\n    var self = this;\n    ADTECH.registerVideoPlayer(self.videoContainer, 'Video');\n    if (self.settings.Layout === 'Fluid' || self.settings.Layout === 'Fluid||Fixed') {\n      self.settings.Width = self.originalWidth * self.utils.aspectRatio;\n      self.settings.Height = self.originalHeight * self.utils.aspectRatio;\n      self.currentAspectRatio = self.utils.aspectRatio;\n    }\n  \tvar smartPlayer = ADTECH.modules.SmartVideoPlayer.createPlayer({\n      container: self.videoContainer,\n      width: self.settings.Width,\n      height: self.settings.Height,\n      poster: self.settings['Preview Image'],\n  \t\tautoplay: false,\n      src: {\n        mp4: self.settings['MP4 File'],\n        webm: self.settings['WEBM File']\n      }\n    });\n    self.videoContainer.style.position = 'absolute';\n    if (self.settings.Layout === 'Fluid' || self.settings.Layout === 'Fluid||Fixed') {\n      self.videoContainer.style.left = self.settings.X + '%';\n      self.videoContainer.style.top = self.settings.Y + '%';\n    } else {\n      self.videoContainer.style.left = self.settings.X + 'px';\n      self.videoContainer.style.top = self.settings.Y + 'px';\n    }\n    if (self.settings['Auto Play'] === true || self.settings['Auto Play'] === 'true') {\n     smartPlayer.play({auto: true});\n    } else {\n     smartPlayer.pause();\n  \t}\n  },\n  updateSize: function() {\n    var self = this;\n    if (self.utils.aspectRatio != self.currentAspectRatio) {\n      self.currentAspectRatio = self.utils.aspectRatio;\n      self.settings.Width = self.settings.Width * (self.utils.aspectRatio*0.9986);\n      self.settings.Height = self.settings.Height * (self.utils.aspectRatio*0.9986);\n      console.log(self.videoContainer.firstChild);\n      self.videoContainer.firstChild.style.width = self.settings.Width + 'px';\n      self.videoContainer.firstChild.style.height = self.settings.Height + 'px';\n    }\n  }\n};\n;\n\n/* Core */\n$1CRI.core = function() {\n  this.settings = new $1CRI.Settings();\n  this.screenDimensions = {};\n  this.addCoreEventListeners();\n  this.requestViewportDimensions();\n};\n\n$1CRI.core.prototype = {\n  init: function() {\n    var self = this;\n    self.container = document.createElement('div');\n    self.container.style.position = 'relative';\n    self.container.id = 'container';\n    document.body.appendChild(self.container);\n    var dims = self.getScreenSize();\n    self.backgroundImage = new $1CRI.imageContainer(dims, self.settings.Image);\n    self.backgroundImage.getImage().addEventListener('click', function() {\n      self.clickHandler();\n    });\n    self.container.appendChild(self.backgroundImage.getImage());\n    if (self.settings.VideoPlayer.Enabled === true || self.settings.VideoPlayer.Enabled === 'true') {\n      self.smartPlayer = new $1CRI.smartVideo.core(self.settings.VideoPlayer, self.container);\n    }\n    var closeButton = new $1CRI.closeButton(self.container, self.settings.CloseButton);\n    self.container.appendChild(closeButton);\n  },\n  requestViewportDimensions: function() {\n    ADTECH.event('viewport', {type:'request'});\n  },\n  addCoreEventListeners: function() {\n    var self = this;\n    ADTECH.addEventListener('viewport', function(event) {\n      if (event.meta.type === 'response') {\n        self.screenDimensions = event.meta.dims;\n        self.init();\n      } else if (event.meta.type === 'update'){\n        self.screenDimensions = event.meta.dims;\n        self.backgroundImage.updateSize(self.screenDimensions);\n        self.smartPlayer.updateSize();\n\n      }\n    });\n  },\n  getScreenSize: function() {\n    return this.screenDimensions;\n  },\n  clickHandler: function() {\n    ADTECH.dynamicClick('Clickthrough', this.settings.Clickthrough);\n  }\n};\nADTECH.ready(['SmartVideoPlayer/1.1.1/SmartVideoPlayer'], function() {\n  'use strict'\n\tnew $1CRI.core();\n});\n\n/*\nADTECH.addEventListener('hello', function() {\n  console.log('HELLOOOOO');\n});\n*/\n;\n"],"sourceRoot":"/source/"}